<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OG Image Generator</title>
    <meta name="description" content="基於 URL 參數產生不同比例、顏色和樣式的 Open Graph 圖片" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="OG Image Generator" />
    <meta property="og:description" content="基於 URL 參數產生不同比例、顏色和樣式的 Open Graph 圖片" />
    <meta property="og:image" id="og-image" content="https://dummyimage.com/16:9x1080/4285f4/ffffff" />
    <meta property="og:image:width" content="1080" />
    <meta property="og:image:height" content="608" />
    <meta property="og:url" content="https://ogimage.example.com" />
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:title" content="OG Image Generator" />
    <meta property="twitter:description" content="基於 URL 參數產生不同比例、顏色和樣式的 Open Graph 圖片" />
    <meta property="twitter:image" id="twitter-image" content="https://dummyimage.com/16:9x1080/4285f4/ffffff" />
    
    <script>
      // 動態更新 OG 圖片 (針對用戶體驗)
      window.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const ratio = urlParams.get('ratio') || '16:9';
        const size = urlParams.get('size') || '1080';
        const bgColor = urlParams.get('bg') || '4285f4';
        const textColor = urlParams.get('color') || 'ffffff';
        
        const imageUrl = `https://dummyimage.com/${ratio}x${size}/${bgColor}/${textColor}`;
        
        // 計算圖片尺寸
        const calculateDimensions = (ratio, size) => {
          const [width, height] = ratio.split(':');
          const widthNum = parseInt(width);
          const heightNum = parseInt(height);
          
          if (widthNum > heightNum) {
            return {
              width: size,
              height: Math.round(size * (heightNum / widthNum))
            };
          } else {
            return {
              width: Math.round(size * (widthNum / heightNum)),
              height: size
            };
          }
        };
        
        const dimensions = calculateDimensions(ratio, parseInt(size));
        
        // 更新 OG 圖片 (僅用於使用者瀏覽時更新視覺效果)
        document.getElementById('og-image').setAttribute('content', imageUrl);
        document.getElementById('twitter-image').setAttribute('content', imageUrl);
        
        // 更新尺寸標籤
        const ogImageWidth = document.querySelector('meta[property="og:image:width"]');
        const ogImageHeight = document.querySelector('meta[property="og:image:height"]');
        
        if (ogImageWidth) {
          ogImageWidth.setAttribute('content', dimensions.width.toString());
        }
        
        if (ogImageHeight) {
          ogImageHeight.setAttribute('content', dimensions.height.toString());
        }
        
        // 更新 URL 標籤，將當前完整 URL 設置到 og:url
        const ogUrl = document.querySelector('meta[property="og:url"]');
        if (ogUrl) {
          ogUrl.setAttribute('content', window.location.href);
        }
        
        // 預加載圖片
        const preloadImage = (url) => {
          const img = new Image();
          img.src = url;
        };
        
        preloadImage(imageUrl);
        
        console.log("OG 圖片已更新:", imageUrl);
        console.log("OG 圖片尺寸:", dimensions.width + "x" + dimensions.height);
      });
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
